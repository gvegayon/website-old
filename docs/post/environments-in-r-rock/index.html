<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.30.2" />
  <meta name="author" content="George G. Vega Yon">
  <meta name="description" content="Research Programmer / Ph.D. Student">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  

  <link rel="alternate" href="https://gvegayon.github.io/index.xml" type="application/rss+xml" title="George G. Vega Yon">
  <link rel="feed" href="https://gvegayon.github.io/index.xml" type="application/rss+xml" title="George G. Vega Yon">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://gvegayon.github.io/post/environments-in-r-rock/">

  

  <title>Environments in R Rock | George G. Vega Yon</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">George G. Vega Yon</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Research</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#talks">
            
            <span>Talks</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Environments in R Rock</h1>
    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2017-10-02 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Oct 2, 2017
    </time>
  </span>

  
  
  
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/r">R</a
    >
    
  </span>
  
  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/tags/r">r</a
    >, 
    
    <a href="/tags/rstats">rstats</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fgvegayon.github.io%2fpost%2fenvironments-in-r-rock%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Environments%20in%20R%20Rock&amp;url=https%3a%2f%2fgvegayon.github.io%2fpost%2fenvironments-in-r-rock%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fgvegayon.github.io%2fpost%2fenvironments-in-r-rock%2f&amp;title=Environments%20in%20R%20Rock"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fgvegayon.github.io%2fpost%2fenvironments-in-r-rock%2f&amp;title=Environments%20in%20R%20Rock"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Environments%20in%20R%20Rock&amp;body=https%3a%2f%2fgvegayon.github.io%2fpost%2fenvironments-in-r-rock%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <p>Last week I found myself working on <a href="https://github.com/USCCANA/netdiffuseR" target="_blank">netdiffuseR</a> trying to establish nice defaults for some plotting functions with the following goals:</p>
<ol style="list-style-type: decimal">
<li><p>Make the code easy to maintain: So if I need to change defaults I just change a few lines and that works for all plot functions,</p></li>
<li><p>Make the code easy to see in the manual (help) file: So is easier to the user to focus on the main features of a plot rather than looking at a large description of a function with lots of parameters and lots of defaults, and</p></li>
<li><p>Make the code hopefully efficient: Not that I care that much, but if I’m going to be passing arguments across functions, it better be efficient!</p></li>
</ol>
<p>So, long story short, I came up with the following approach:</p>
<ol style="list-style-type: decimal">
<li><p>Create a list of defaults included in the package: This is actually something that I’ve already seen in some other places, like for example <a href="https://github.com/igraph/rigraph/blob/665d71ebd40cdfe9b996a4f50c35d65b791e4102/R/par.R" target="_blank">igraph</a>, they have a couple of environments that set plotting defaults.</p></li>
<li><p>Make a heavy use of the ellipsis! <code>...</code> So I can actually grab whatever the user passed through it, and later modify the arguments (I’ll show this in an example)</p></li>
<li><p>Use 1. to modify 2. at will… with environments!</p></li>
</ol>
<p>While I’m not sure this is the most efficient way of doing this (and I’m pretty sure that I’m not the first person to do something like this), it works for what I’m doing right now. The following piece of code illustrates how this works.</p>
<p>This is a list of the defaults that we would like all the functions to have:</p>
<pre class="r"><code># This list holds the default parameters
defaults &lt;- list(color=&quot;steelblue&quot;, add=FALSE)</code></pre>
<p>This function is the one that sets the defaults, follow the comments to see how it works:</p>
<pre class="r"><code># This function sets the defaults giving the name of an object that holds the
# parameters... or at least should hold them!
set.defaults &lt;- function(obj_name) {
  
  # Where was this function called from? This way we get
  # the parent frame (the environment from where the function was called)
  # this actually holds all the elements, but works as a reference, so no copy!
  env &lt;- parent.frame()
  
  # Now we loop throught the defaults that I&#39;ve specified
  # in -defaults-
  for (d in names(defaults))
    # If -d- hasn&#39;t been specified, then set it!
    if (!length(env[[obj_name]][[d]]))
      env[[obj_name]][[d]] &lt;- defaults[[d]]
}</code></pre>
<p>This is a function that illustrates how everything works together. So we can pass extra arguments with the ellipsis, we store them in a list called <code>dots</code> (I’m sure there must be a more efficient way of doing this, but it’s OK for now :]), sets the defaults calling <code>set.defaults</code>, and returns the <code>dots</code> list:</p>
<pre class="r"><code>f &lt;- function(...) {
  
  # Getting the dots
  dots &lt;- list(...)
  
  # Setting defaults
  set.defaults(&quot;dots&quot;)
  
  # Did we got them?
  return(dots)
}</code></pre>
<p>Now let’s see if it works!</p>
<pre class="r"><code>f()</code></pre>
<pre><code>## $color
## [1] &quot;steelblue&quot;
## 
## $add
## [1] FALSE</code></pre>
<pre class="r"><code>f(color=&quot;green&quot;)</code></pre>
<pre><code>## $color
## [1] &quot;green&quot;
## 
## $add
## [1] FALSE</code></pre>
<p>As expected, the first call of the function returns the default parameters. In the second call, since I specified <code>&quot;green&quot;</code>, the function <code>set.defaults</code> only set the argument <code>add</code>.</p>
<p>You can read more about environments in <a href="http://adv-r.had.co.nz/Environments.html" target="_blank">Hadley Wickham’s Advance R</a>.</p>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://gvegayon.github.io/post/sistema-de-pensiones-en-chile/"><span
      aria-hidden="true">&larr;</span> Sistema de Pensiones en Chile</a></li>
    

    
    <li class="next"><a href="https://gvegayon.github.io/post/research-software-dev/">Research != Software dev? <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2016 George G. Vega Yon &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

